<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- meta정보 -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- 구글 폰트 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=BhuTuka+Expanded+One&family=Comfortaa:wght@600&family=Do+Hyeon&family=Gowun+Dodum&family=Hi+Melody&family=Nanum+Pen+Script&family=Noto+Sans+SC:wght@100;400&family=Oswald:wght@300&family=Permanent+Marker&family=Quintessential&family=Rowdies:wght@300;400&family=Sedgwick+Ave&family=Shadows+Into+Light&family=Source+Code+Pro:wght@200&family=Staatliches&family=Stylish&family=Sunflower:wght@300&family=ZCOOL+QingKe+HuangYou&display=swap"
      rel="stylesheet"
    />

    <!-- 부트스트랩 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.6.0.slim.js"
      integrity="sha256-HwWONEZrpuoh951cQD1ov2HUK5zA5DwJ1DNUXaM6FsY="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>

    <!-- jQuery -->
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <title>간지나는 당신 곁엔,NearFetch</title>
  </head>
  <body>
    <!-- 헤더 -->
    <header include-html="/NEARFETCH_js_version/component/header.html"></header>

    <!-- 메인 -->
    <main>
      <div class="section searchItemWrapper">
        <div class="currentCategoryWrapper">
          <ul class="currentCategory">
            <li id="currentGender">
              <a href="">여성</a>
              <img src="/images/next.png" alt="" width="15px" />
            </li>
            <li id="currentBrand">
              <a href="">MAISON MARGIELA</a>
            </li>
          </ul>
        </div>

        <!-- 카테고리 필터&정렬 필터 -->
        <div class="sortingWrapper">
          <!-- 카테고리 필터(좌) -->
          <div include-html="/NEARFETCH_js_version/component/filter.html"></div>

          <!-- 정렬 필터 -->
          <div include-html="/NEARFETCH_js_version/component/sorter.html"></div>
        </div>

        <!-- 아이템자리 -->
        <div class="itemListWrapper">
          <!-- 상품리스트 -->
        </div>
      </div>
    </main>

    <!-- 푸터 -->
    <footer include-html="/NEARFETCH_js_version/component/footer.html"></footer>
    <!-- 연결 css/js/jquery 파일 -->
    <link rel="stylesheet" href="/NEARFETCH_js_version/style.css" />
    <script src="/NEARFETCH_js_version/common.js" defer></script>
    <script src="/NEARFETCH_js_version/commonJquery.js"></script>
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script>
      //   console.log(localStorage.getItem("searchKeyword"));
      fetch(
        `http://172.20.10.6:8000/products/search?word=${localStorage.getItem(
          "searchKeyword"
        )}`,
        {
          method: "GET",
          headers: {
            "Content-Type": "application/json",
          },
        }
      )
        .then((response) => response.json())
        .then((response) => {
          console.log(response.result);
          const searchItemListWrapper = document.querySelector(
            ".searchItemWrapper .itemListWrapper"
          );
          const ul = document.createElement("ul");
          searchItemListWrapper.appendChild(ul);
          for (let i = 0; i < response.result.length; i += 1) {
            // 추천 상품(여성,bags 제품을 객체에 담은 후 랜덤추출)

            const cart = document.createElement("img");
            cart.setAttribute("class", "cart");
            cart.src = "/images/shopping-cart.png";
            const aTag = document.createElement("a");
            aTag.setAttribute("class", "imgWrapAtag");
            aTag.href =
              "http://127.0.0.1:5500/NEARFETCH_js_version/item%20detail/itemdetail.html";
            const img = document.createElement("img");
            img.setAttribute("class", "itemImg");
            img.src = response.result[i].itemImg[0];
            const li = document.createElement("li");
            ul.appendChild(li);
            li.appendChild(cart);
            aTag.appendChild(img);
            li.appendChild(aTag);
            const classList = [
              "itemBrand",
              "itemName",
              "price",
              "sale_price",
              "skuNum",
            ];
            for (let k = 0; k < classList.length; k++) {
              const div = document.createElement("div");
              div.setAttribute("class", classList[k]);
              li.appendChild(div);
            }
            document.querySelectorAll(".itemListWrapper .itemBrand")[
              i
            ].innerText = response.result[i][classList[0]];
            document.querySelectorAll(".itemListWrapper .itemName")[
              i
            ].innerText = response.result[i][classList[1]];
            document.querySelectorAll(".itemListWrapper .price")[i].innerText =
              response.result[i][classList[2]];
            document.querySelectorAll(".itemListWrapper .sale_price")[
              i
            ].innerText = response.result[i][classList[3]];
            document.querySelectorAll(".itemListWrapper .skuNum")[i].innerText =
              response.result[i][classList[4]];
          }
        });
    </script>
  </body>
</html>
